#!/usr/bin/env bash

SERVER_XML_FILE="/srv/tomcat8/conf/server.xml"
SERVER_XML_TEMPLATE="/srv/tomcat8/conf/server.template.xml"

cp "${SERVER_XML_TEMPLATE}" "${SERVER_XML_FILE}"

replaceVarInFile "TOMCAT_PROXY_REMOTE_IP_HEADER" "${TOMCAT_PROXY_REMOTE_IP_HEADER}" "${SERVER_XML_FILE}"
replaceVarInFile "TOMCAT_PROXY_INTERNAL_PROXIES" "${TOMCAT_PROXY_REMOTE_IP_HEADER}" "${SERVER_XML_FILE}"
replaceVarInFile "TOMCAT_PROXY_PROXIES_HEADER" "${TOMCAT_PROXY_PROXIES_HEADER}" "${SERVER_XML_FILE}"
replaceVarInFile "TOMCAT_PROXY_PROTOCOL_HEADER" "${TOMCAT_PROXY_PROTOCOL_HEADER}" "${SERVER_XML_FILE}"
replaceVarInFile "TOMCAT_PROXY_HTTP_SERVER_PORT" "${TOMCAT_PROXY_HTTP_SERVER_PORT}" "${SERVER_XML_FILE}"
replaceVarInFile "TOMCAT_PROXY_HTTPS_SERVER_PORT" "${TOMCAT_PROXY_HTTPS_SERVER_PORT}" "${SERVER_XML_FILE}"
